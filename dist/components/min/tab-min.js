!function($,e,t,a){"use strict";e="undefined"!=typeof e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),$.fn.tab=function(n){var i=$($.isFunction(this)?e:this),o=i.selector||"",r=(new Date).getTime(),s=[],c=arguments[0],l="string"==typeof c,d=[].slice.call(arguments,1),u=!1,b;return i.each(function(){var g=$.isPlainObject(n)?$.extend(!0,{},$.fn.tab.settings,n):$.extend({},$.fn.tab.settings),f=g.className,h=g.metadata,p=g.selector,m=g.error,v="."+g.namespace,y="module-"+g.namespace,T=$(this),L,x,A={},P=!0,C=0,F=this,S=T.data(y),j,E,w,k;w={initialize:function(){w.debug("Initializing tab menu item",T),w.fix.callbacks(),w.determineTabs(),w.debug("Determining tabs",g.context,x),g.auto&&w.set.auto(),w.bind.events(),g.history&&!u&&(w.initializeHistory(),u=!0),w.instantiate()},instantiate:function(){w.verbose("Storing instance of module",w),S=w,T.data(y,w)},destroy:function(){w.debug("Destroying tabs",T),T.removeData(y).off(v)},bind:{events:function(){$.isWindow(F)||(w.debug("Attaching tab activation events to element",T),T.on("click"+v,w.event.click))}},determineTabs:function(){var e;"parent"===g.context?(T.closest(p.ui).length>0?(e=T.closest(p.ui),w.verbose("Using closest UI element as parent",e)):e=T,L=e.parent(),w.verbose("Determined parent element for creating context",L)):g.context?(L=$(g.context),w.verbose("Using selector for tab context",g.context,L)):L=$("body"),g.childrenOnly?(x=L.children(p.tabs),w.debug("Searching tab context children for tabs",L,x)):(x=L.find(p.tabs),w.debug("Searching tab context for tabs",L,x))},fix:{callbacks:function(){$.isPlainObject(n)&&(n.onTabLoad||n.onTabInit)&&(n.onTabLoad&&(n.onLoad=n.onTabLoad,delete n.onTabLoad,w.error(m.legacyLoad,n.onLoad)),n.onTabInit&&(n.onFirstLoad=n.onTabInit,delete n.onTabInit,w.error(m.legacyInit,n.onFirstLoad)),g=$.extend(!0,{},$.fn.tab.settings,n))}},initializeHistory:function(){if(w.debug("Initializing page state"),$.address===a)return w.error(m.state),!1;if("state"==g.historyType){if(w.debug("Using HTML5 to manage state"),g.path===!1)return w.error(m.path),!1;$.address.history(!0).state(g.path)}$.address.bind("change",w.event.history.change)},event:{click:function(e){var t=$(this).data(h.tab);t!==a?(g.history?(w.verbose("Updating page state",e),$.address.value(t)):(w.verbose("Changing tab",e),w.changeTab(t)),e.preventDefault()):w.debug("No tab specified")},history:{change:function(e){var t=e.pathNames.join("/")||w.get.initialPath(),n=g.templates.determineTitle(t)||!1;w.performance.display(),w.debug("History change event",t,e),k=e,t!==a&&w.changeTab(t),n&&$.address.title(n)}}},refresh:function(){j&&(w.debug("Refreshing tab",j),w.changeTab(j))},cache:{read:function(e){return e!==a&&A[e]},add:function(e,t){e=e||j,w.debug("Adding cached content for",e),A[e]=t},remove:function(e){e=e||j,w.debug("Removing cached content for",e),delete A[e]}},set:{auto:function(){var e="string"==typeof g.path?g.path.replace(/\/$/,"")+"/{$tab}":"/{$tab}";w.verbose("Setting up automatic tab retrieval from server",e),$.isPlainObject(g.apiSettings)?g.apiSettings.url=e:g.apiSettings={url:e}},loading:function(e){var t=w.get.tabElement(e),a=t.hasClass(f.loading);a||(w.verbose("Setting loading state for",t),t.addClass(f.loading).siblings(x).removeClass(f.active+" "+f.loading),t.length>0&&g.onRequest.call(t[0],e))},state:function(e){$.address.value(e)}},changeTab:function(t){var a=e.history&&e.history.pushState,n=a&&g.ignoreFirstLoad&&P,i=g.auto||$.isPlainObject(g.apiSettings),o=i&&!n?w.utilities.pathToArray(t):w.get.defaultPathArray(t);t=w.utilities.arrayToPath(o),$.each(o,function(e,a){var r=o.slice(0,e+1),s=w.utilities.arrayToPath(r),c=w.is.tab(s),l=e+1==o.length,d=w.get.tabElement(s),u,b,p,v;if(w.verbose("Looking for tab",a),c){if(w.verbose("Tab was found",a),j=s,E=w.utilities.filterArray(o,r),l?v=!0:(b=o.slice(0,e+2),p=w.utilities.arrayToPath(b),v=!w.is.tab(p),v&&w.verbose("Tab parameters found",b)),v&&i)return n?(w.debug("Ignoring remote content on first tab load",s),P=!1,w.cache.add(t,d.html()),w.activate.all(s),g.onFirstLoad.call(d[0],s,E,k),g.onLoad.call(d[0],s,E,k)):(w.activate.navigation(s),w.fetch.content(s,t)),!1;w.debug("Opened local tab",s),w.activate.all(s),w.cache.read(s)||(w.cache.add(s,!0),w.debug("First time tab loaded calling tab init"),g.onFirstLoad.call(d[0],s,E,k)),g.onLoad.call(d[0],s,E,k)}else{if(t.search("/")!=-1||""===t)return w.error(m.missingTab,T,L,s),!1;if(u=$("#"+t+', a[name="'+t+'"]'),s=u.closest("[data-tab]").data(h.tab),d=w.get.tabElement(s),u&&u.length>0&&s)return w.debug("Anchor link used, opening parent tab",d,u),d.hasClass(f.active)||setTimeout(function(){w.scrollTo(u)},0),w.activate.all(s),w.cache.read(s)||(w.cache.add(s,!0),w.debug("First time tab loaded calling tab init"),g.onFirstLoad.call(d[0],s,E,k)),g.onLoad.call(d[0],s,E,k),!1}})},scrollTo:function(e){var a=!!(e&&e.length>0)&&e.offset().top;a!==!1&&(w.debug("Forcing scroll to an in-page link in a hidden tab",a,e),$(t).scrollTop(a))},update:{content:function(e,t,n){var i=w.get.tabElement(e),o=i[0];n=n!==a?n:g.evaluateScripts,"string"==typeof g.cacheType&&"dom"==g.cacheType.toLowerCase()&&"string"!=typeof t?i.empty().append($(t).clone(!0)):n?(w.debug("Updating HTML and evaluating inline scripts",e,t),i.html(t)):(w.debug("Updating HTML",e,t),o.innerHTML=t)}},fetch:{content:function(e,t){var n=w.get.tabElement(e),i={dataType:"html",encodeParameters:!1,on:"now",cache:g.alwaysRefresh,headers:{"X-Remote":!0},onSuccess:function(a){"response"==g.cacheType&&w.cache.add(t,a),w.update.content(e,a),e==j?(w.debug("Content loaded",e),w.activate.tab(e)):w.debug("Content loaded in background",e),g.onFirstLoad.call(n[0],e,E,k),g.onLoad.call(n[0],e,E,k),"string"==typeof g.cacheType&&"dom"==g.cacheType.toLowerCase()&&n.children().length>0?setTimeout(function(){var e=n.children().clone(!0);e=e.not("script"),w.cache.add(t,e)},0):w.cache.add(t,n.html())},urlData:{tab:t}},o=n.api("get request")||!1,r=o&&"pending"===o.state(),s,c;t=t||e,c=w.cache.read(t),g.cache&&c?(w.activate.tab(e),w.debug("Adding cached content",t),"once"==g.evaluateScripts?w.update.content(e,c,!1):w.update.content(e,c),g.onLoad.call(n[0],e,E,k)):r?(w.set.loading(e),w.debug("Content is already loading",t)):$.api!==a?(s=$.extend(!0,{},g.apiSettings,i),w.debug("Retrieving remote content",t,s),w.set.loading(e),n.api(s)):w.error(m.api)}},activate:{all:function(e){w.activate.tab(e),w.activate.navigation(e)},tab:function(e){var t=w.get.tabElement(e),a="siblings"==g.deactivate?t.siblings(x):x.not(t),n=t.hasClass(f.active);w.verbose("Showing tab content for",t),n||(t.addClass(f.active),a.removeClass(f.active+" "+f.loading),t.length>0&&g.onVisible.call(t[0],e))},navigation:function(e){var t=w.get.navElement(e),a="siblings"==g.deactivate?t.siblings(i):i.not(t),n=t.hasClass(f.active);w.verbose("Activating tab navigation for",t,e),n||(t.addClass(f.active),a.removeClass(f.active+" "+f.loading))}},deactivate:{all:function(){w.deactivate.navigation(),w.deactivate.tabs()},navigation:function(){i.removeClass(f.active)},tabs:function(){x.removeClass(f.active+" "+f.loading)}},is:{tab:function(e){return e!==a&&w.get.tabElement(e).length>0}},get:{initialPath:function(){return i.eq(0).data(h.tab)||x.eq(0).data(h.tab)},path:function(){return $.address.value()},defaultPathArray:function(e){return w.utilities.pathToArray(w.get.defaultPath(e))},defaultPath:function(e){var t=i.filter("[data-"+h.tab+'^="'+e+'/"]').eq(0),a=t.data(h.tab)||!1;if(a){if(w.debug("Found default tab",a),C<g.maxDepth)return C++,w.get.defaultPath(a);w.error(m.recursion)}else w.debug("No default tabs found for",e,x);return C=0,e},navElement:function(e){return e=e||j,i.filter("[data-"+h.tab+'="'+e+'"]')},tabElement:function(e){var t,a,n,i;return e=e||j,n=w.utilities.pathToArray(e),i=w.utilities.last(n),t=x.filter("[data-"+h.tab+'="'+e+'"]'),a=x.filter("[data-"+h.tab+'="'+i+'"]'),t.length>0?t:a},tab:function(){return j}},utilities:{filterArray:function(e,t){return $.grep(e,function(e){return $.inArray(e,t)==-1})},last:function(e){return!!$.isArray(e)&&e[e.length-1]},pathToArray:function(e){return e===a&&(e=j),"string"==typeof e?e.split("/"):[e]},arrayToPath:function(e){return!!$.isArray(e)&&e.join("/")}},setting:function(e,t){if(w.debug("Changing setting",e,t),$.isPlainObject(e))$.extend(!0,g,e);else{if(t===a)return g[e];$.isPlainObject(g[e])?$.extend(!0,g[e],t):g[e]=t}},internal:function(e,t){if($.isPlainObject(e))$.extend(!0,w,e);else{if(t===a)return w[e];w[e]=t}},debug:function(){!g.silent&&g.debug&&(g.performance?w.performance.log(arguments):(w.debug=Function.prototype.bind.call(console.info,console,g.name+":"),w.debug.apply(console,arguments)))},verbose:function(){!g.silent&&g.verbose&&g.debug&&(g.performance?w.performance.log(arguments):(w.verbose=Function.prototype.bind.call(console.info,console,g.name+":"),w.verbose.apply(console,arguments)))},error:function(){g.silent||(w.error=Function.prototype.bind.call(console.error,console,g.name+":"),w.error.apply(console,arguments))},performance:{log:function(e){var t,a,n;g.performance&&(t=(new Date).getTime(),n=r||t,a=t-n,r=t,s.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:F,"Execution Time":a})),clearTimeout(w.performance.timer),w.performance.timer=setTimeout(w.performance.display,500)},display:function(){var e=g.name+":",t=0;r=!1,clearTimeout(w.performance.timer),$.each(s,function(e,a){t+=a["Execution Time"]}),e+=" "+t+"ms",o&&(e+=" '"+o+"'"),(console.group!==a||console.table!==a)&&s.length>0&&(console.groupCollapsed(e),console.table?console.table(s):$.each(s,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),s=[]}},invoke:function(e,t,n){var i=S,o,r,s;return t=t||d,n=F||n,"string"==typeof e&&i!==a&&(e=e.split(/[\. ]/),o=e.length-1,$.each(e,function(t,n){var s=t!=o?n+e[t+1].charAt(0).toUpperCase()+e[t+1].slice(1):e;if($.isPlainObject(i[s])&&t!=o)i=i[s];else{if(i[s]!==a)return r=i[s],!1;if(!$.isPlainObject(i[n])||t==o)return i[n]!==a?(r=i[n],!1):(w.error(m.method,e),!1);i=i[n]}})),$.isFunction(r)?s=r.apply(n,t):r!==a&&(s=r),$.isArray(b)?b.push(s):b!==a?b=[b,s]:s!==a&&(b=s),r}},l?(S===a&&w.initialize(),w.invoke(c)):(S!==a&&S.invoke("destroy"),w.initialize())}),b!==a?b:this},$.tab=function(){$(e).tab.apply(this,arguments)},$.fn.tab.settings={name:"Tab",namespace:"tab",silent:!1,debug:!1,verbose:!1,performance:!0,auto:!1,history:!1,historyType:"hash",path:!1,context:!1,childrenOnly:!1,maxDepth:25,deactivate:"siblings",alwaysRefresh:!1,cache:!0,cacheType:"response",ignoreFirstLoad:!1,apiSettings:!1,evaluateScripts:"once",onFirstLoad:function(e,t,a){},onLoad:function(e,t,a){},onVisible:function(e,t,a){},onRequest:function(e,t,a){},templates:{determineTitle:function(e){}},error:{api:"You attempted to load content without API module",method:"The method you called is not defined",missingTab:"Activated tab cannot be found. Tabs are case-sensitive.",noContent:"The tab you specified is missing a content url.",path:"History enabled, but no path was specified",recursion:"Max recursive depth reached",legacyInit:"onTabInit has been renamed to onFirstLoad in 2.0, please adjust your code.",legacyLoad:"onTabLoad has been renamed to onLoad in 2.0. Please adjust your code",state:"History requires Asual's Address library <https://github.com/asual/jquery-address>"},metadata:{tab:"tab",loaded:"loaded",promise:"promise"},className:{loading:"loading",active:"active"},selector:{tabs:".ui.tab",ui:".ui"}}}(jQuery,window,document);